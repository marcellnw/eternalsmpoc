<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pendaftaran OC | EternalSMP</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root {
      --gold: #ffd700;
      --dark: #0e0e0e;
      --light: #ffffff;
      --bg: #1c1c1c;
    }

    body {
      background: var(--bg);
      color: var(--light);
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #000;
      color: var(--gold);
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--gold);
      position: relative;
    }

    header h1 {
      font-family: 'Cinzel', serif;
      font-size: 1.5rem;
      margin: 0;
    }

    .btn-back {
      position: absolute;
      right: 1.5rem;
      top: 1rem;
      background: none;
      border: none;
      color: var(--gold);
      font-size: 0.95rem;
      cursor: pointer;
    }

    .btn-back i {
      margin-right: 4px;
    }

    h2 {
      font-size: 1.5rem;
      text-align: center;
      font-family: 'Cinzel', serif;
      color: var(--gold);
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <audio id="clickSound" src="https://raw.githubusercontent.com/marcellnw/eternalsmp-pendaftaran-oc/main/click.m4a"></audio>
  <audio id="click2Sound" src="https://raw.githubusercontent.com/marcellnw/eternalsmp-pendaftaran-oc/main/Click2.m4a"></audio>

  <header>
    <h1>Pendaftaran OC</h1>
    <button class="btn-back" onclick="playClick2(); window.location.href='index.html'">
      <i class="fas fa-arrow-left"></i> Kembali
    </button>
  </header>

  <h2>ğŸ“ Daftarkan Karakter Originalmu</h2>

  <form id="ocForm" style="max-width: 960px; margin: auto; padding: 1rem;">
    <div style="display: flex; flex-wrap: wrap; gap: 2rem;">
      <!-- Kolom Kiri -->
      <div style="flex: 1 1 300px; display: flex; flex-direction: column; gap: 1rem;">
        
        <label for="gamertag">ğŸ® Nama Gamertag
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Masukkan nama Minecraft kamu (tanpa spasi, 3â€“16 karakter).</small>
        </label>
        <input type="text" id="gamertag" name="gamertag" required style="padding: 0.6rem; border-radius: 8px; border: none;" />

        <label for="ocname">ğŸ‘¤ Nama Karakter OC
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Nama karakter ciptaanmu di dunia EternalSMP.</small>
        </label>
        <input type="text" id="ocname" name="ocname" required style="padding: 0.6rem; border-radius: 8px; border: none;" />

        <label for="race">ğŸ§¬ Ras
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Pilih ras yang sesuai dengan latar belakang dan kekuatan karaktermu.</small>
        </label>
        <select id="race" name="race" required style="padding: 0.6rem; border-radius: 8px; border: none;">
          <option value="">-- Pilih Ras --</option>
          <option value="Euria">ğŸ§šâ€â™€ï¸ Euria - Peri cahaya, penjaga alam</option>
          <option value="Graveth">ğŸ¦… Graveth - Manusia burung ahli sihir gelap</option>
          <option value="Maredien">ğŸ‘‘ Maredien - Bangsawan diplomatis</option>
          <option value="Heretic">ğŸ”® Heretic - Pengguna sihir terlarang</option>
          <option value="Diablonic">ğŸ˜ˆ Diablonic - Iblis haus kekuasaan</option>
          <option value="Laurian">ğŸ¹ Laurian - Pemburu dan pelindung hutan</option>
        </select>

        <label for="class">âš”ï¸ Class
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Peran utama dalam pertempuran atau petualangan karakter OC kamu.</small>
        </label>
        <select id="class" name="class" required style="padding: 0.6rem; border-radius: 8px; border: none;">
          <option value="">-- Pilih Class --</option>
          <option value="Warrior">ğŸ›¡ï¸ Warrior - Petarung seimbang</option>
          <option value="Berserker">ğŸ’¢ Berserker - Liar & brutal</option>
          <option value="Tank">ğŸª– Tank - Pertahanan tinggi</option>
          <option value="Lancer">ğŸ‡ Lancer - Cepat & menusuk</option>
          <option value="Rogue">ğŸ•µï¸ Rogue - Licik & lincah</option>
          <option value="Hunter">ğŸ¹ Hunter - Ahli jarak jauh</option>
          <option value="Ronin">ğŸ—¡ï¸ Ronin - Pendekar bebas</option>
          <option value="Swordmage">âš”ï¸ğŸ§™ Swordmage - Pedang & sihir</option>
          <option value="Priest">ğŸ™ Priest - Penyembuh</option>
        </select>

        <!-- Kolom Kanan -->
      <div style="flex: 1 1 300px; display: flex; flex-direction: column; gap: 1rem;">
        
        <label for="job">ğŸ”¨ Job
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Pekerjaan utama karaktermu dalam kehidupan sehari-hari.</small>
        </label>
        <select id="job" name="job" required style="padding: 0.6rem; border-radius: 8px; border: none;">
          <option value="">-- Pilih Job --</option>
          <option value="Alchemist">ğŸ§ª Alchemist - Pembuat ramuan</option>
          <option value="Blacksmith">âš’ï¸ Blacksmith - Pandai besi</option>
          <option value="Trader">ğŸ’° Trader - Ahli jual beli</option>
          <option value="Farmer">ğŸŒ¾ Farmer - Petani</option>
          <option value="Nitwit">ğŸ™ƒ Nitwit - Belum memiliki keahlian</option>
        </select>

        <label for="role">ğŸ‘‘ Role Sosial
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Kedudukan sosial karaktermu dalam dunia EternalSMP.</small>
        </label>
        <select id="role" name="role" required style="padding: 0.6rem; border-radius: 8px; border: none;">
          <option value="">-- Pilih Role --</option>
          <option value="Raja">ğŸ‘‘ Raja - Pemimpin kerajaan</option>
          <option value="Bangsawan">ğŸ’¼ Bangsawan - Tokoh berpengaruh</option>
          <option value="Royalis">ğŸ° Royalis - Pendukung kerajaan</option>
          <option value="Worker">ğŸ‘· Worker - Rakyat biasa</option>
        </select>

        <label for="image">ğŸ–¼ï¸ Upload Gambar Karakter
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Opsional: Unggah potret karakter (PNG/JPG).</small>
        </label>
        <input type="file" id="image" name="image" accept="image/*" style="padding: 0.4rem; background: #fff; border-radius: 8px;" />

        <label for="sifat">ğŸ­ Sifat & Kepribadian
          <small style="display:block; font-size: 0.85rem; color: #ccc;">Jelaskan sifat dominan, kebiasaan, atau karakter khas OC kamu (min. 50 kata).</small>
        </label>
        <textarea id="sifat" name="sifat" minlength="50" required style="padding: 0.6rem; border-radius: 8px; resize: vertical;"></textarea>

      </div> <!-- akhir kolom kanan -->
    </div> <!-- akhir row form -->

      <!-- Kembali ke Page 1 -->
    <div style="position: absolute; top: 16px; right: 20px;">
      <button type="button" onclick="playClick2(); backToHome()" style="background: none; border: none; font-size: 0.95rem; color: #ffd700; cursor: pointer;">
        â¬…ï¸ Kembali ke Page 1
      </button>
    </div>

    <!-- Lore -->
    <label for="lore" style="margin-top: 2rem;">ğŸ“– Lore & Background
      <small style="display:block; font-size: 0.85rem; color: #ccc;">Tuliskan sejarah, asal-usul, atau perjalanan penting dalam hidup OC-mu (500â€“3000 kata). Lore akan membentuk identitas dunia dan interaksi dengan karakter lain.</small>
    </label>
    <textarea id="lore" name="lore" minlength="500" maxlength="3000" required style="padding: 0.8rem; border-radius: 8px; resize: vertical; min-height: 200px;"></textarea>

    <!-- Tujuan -->
    <label for="tujuan" style="margin-top: 1.5rem;">ğŸ¯ Tujuan & Motivasi
      <small style="display:block; font-size: 0.85rem; color: #ccc;">Apa motivasi karakter ini di Eternal SMP? (Minimal 100 kata, maksimal 1000). Misal: balas dendam, membangun kerajaan, melindungi seseorang, dll.</small>
    </label>
    <textarea id="tujuan" name="tujuan" minlength="100" maxlength="1000" required style="padding: 0.8rem; border-radius: 8px; resize: vertical; min-height: 160px;"></textarea>

    <!-- Tombol -->
    <div style="display: flex; flex-direction: column; align-items: center; margin-top: 2rem; gap: 12px;">
      <button type="button" class="btn" onclick="playClick(); showPreview()" style="padding: 0.5rem 1.2rem; max-width: 250px; width: 100%;">ğŸ‘ï¸ Preview</button>
      <button type="button" class="btn" onclick="playClick(); submitToDiscord()" style="padding: 0.5rem 1.2rem; max-width: 250px; width: 100%;">ğŸ“¨ Kirim Pendaftaran</button>
    </div>
  </form>
</div> <!-- akhir #formPage -->
  <!-- Preview Page -->
<div class="container hidden" id="previewPage">
  <h2 style="font-family: 'Cinzel', serif; color: #ffd700; text-align:center;">ğŸ‘ï¸ Preview Karakter OC</h2>

  <div style="background:#000; border:1px solid #ffd700; border-radius:12px; padding:20px; max-height:500px; overflow-y:auto; margin-bottom:20px;">
    <pre id="previewContent" style="white-space:pre-wrap; color:#fff; font-size:0.95rem;"></pre>
  </div>

  <div style="display:flex; flex-direction:column; align-items:center; gap:12px;">
    <button class="btn" onclick="playClick2(); backToForm()" style="padding:0.5rem 1rem; max-width:250px; width:100%;">ğŸ” Kembali ke Formulir</button>
    <button class="btn" onclick="playClick(); submitToDiscord()" style="padding:0.5rem 1rem; max-width:250px; width:100%;">ğŸ“¨ Kirim Pendaftaran</button>
  </div>
</div>

  <footer style="margin-top: 40px;">
  <p style="text-align:center; color: #aaa;">&copy; 2025 Eternal SMP. All rights reserved.</p>
  <ul class="social" style="display: flex; justify-content: center; gap: 12px; list-style: none; padding: 0; margin-top: 8px;">
    <li><a href="https://instagram.com/eternalsmp" target="_blank"><i class="fab fa-instagram" style="color:#e4405f; font-size: 20px;"></i></a></li>
    <li><a href="https://youtube.com/@eternalsmpserver" target="_blank"><i class="fab fa-youtube" style="color:#ff0000; font-size: 20px;"></i></a></li>
    <li><a href="https://www.tiktok.com/@eternalsmpserver" target="_blank"><i class="fab fa-tiktok" style="color:#fff; font-size: 20px;"></i></a></li>
  </ul>
  </footer>

  <script>
// ğŸ”Š Suara Klik
function playClick() {
  document.getElementById("clickSound").play();
}
function playClick2() {
  document.getElementById("Click2Sound").play();
}

// ğŸ”€ Navigasi Halaman
function showPage(pageId) {
  document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
  document.getElementById(pageId).classList.remove("hidden");
}
function openForm() { showPage("formPage"); }
function backToHome() { window.location.href = "index.html"; } // page 1
function backToForm() { showPage("formPage"); }

// ğŸ§¾ Label & Emoji Mapping
const keyMap = {
  gamertag: "Nama Gamertag",
  ocname: "Nama Karakter OC",
  race: "Ras",
  class: "Class",
  job: "Job",
  role: "Role Sosial",
  sifat: "Sifat & Kepribadian",
  lore: "Lore & Background",
  tujuan: "Tujuan & Motivasi"
};
const emojiMap = {
  gamertag: "ğŸ®",
  ocname: "ğŸ‘¤",
  race: "ğŸ§¬",
  class: "âš”ï¸",
  job: "ğŸ”¨",
  role: "ğŸ‘‘",
  sifat: "ğŸ­",
  lore: "ğŸ“–",
  tujuan: "ğŸ¯"
};

// âœ… Validasi
function validateFormInputs() {
  const gamertag = document.querySelector('input[name="gamertag"]').value.trim();
  const ocname = document.querySelector('input[name="ocname"]').value.trim();
  const sifat = document.querySelector('textarea[name="sifat"]').value.trim();
  const lore = document.querySelector('textarea[name="lore"]').value.trim();
  const tujuan = document.querySelector('textarea[name="tujuan"]').value.trim();

  const gamertagPattern = /^[a-zA-Z0-9_]{3,16}$/;
  const ocnamePattern = /^[a-zA-Z\s]{3,}$/;

  if (!gamertagPattern.test(gamertag)) {
    alert("Gamertag hanya boleh huruf, angka, dan _ (3-16 karakter)");
    return false;
  }
  if (!ocnamePattern.test(ocname)) {
    alert("Nama OC hanya boleh huruf dan spasi, minimal 3 karakter");
    return false;
  }
  if (sifat.length < 50 || lore.length < 500 || tujuan.length < 300) {
    alert("Pastikan teks panjang mencukupi (Sifat 50+, Lore 500+, Tujuan 300+ karakter)");
    return false;
  }
  return true;
}

// ğŸ‘ï¸ Preview Halaman Terpisah
function showPreview() {
  const form = document.getElementById("ocForm");
  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }
  if (!validateFormInputs()) return;

  const data = new FormData(form);
  let content = "";
  for (let [key, value] of data.entries()) {
    if (key !== "image") {
      const label = keyMap[key] || key;
      const emoji = emojiMap[key] || "";
      content += `${emoji} ${label}:\n${value}\n\n`;
    }
  }
  document.getElementById("previewContent").innerText = content;
  showPage("previewPage");
}

// ğŸ“© Kirim ke Discord
async function submitToDiscord() {
  const form = document.getElementById("ocForm");
  const data = new FormData(form);

  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }
  if (!validateFormInputs()) return;
  if (!confirm("Apakah kamu yakin ingin mengirim pendaftaran ini?")) return;

  const imageFile = data.get("image");
  if (imageFile && imageFile.name && !imageFile.type.startsWith("image/")) {
    alert("File yang diunggah harus berupa gambar.");
    return;
  }

  const fields = [];
  for (let [key, value] of data.entries()) {
    if (key !== "image" && value.trim() !== "") {
      const emoji = emojiMap[key] || "";
      const label = keyMap[key] || key;
      const chunks = value.trim().match(/[\s\S]{1,1000}/g) || [];
      chunks.forEach((chunk, i) => {
        fields.push({
          name: `${emoji} ${label}${chunks.length > 1 ? ` (Bagian ${i + 1})` : ""}`,
          value: chunk,
          inline: false
        });
      });
    }
  }

  const webhook = "https://discord.com/api/webhooks/1389899055672594494/ap4v8BlHwvs8JL8RXmisbPcZDsBZBCImJfkQdawlXPKAN8Uw8rWKPLSnL7P5WOf5vDm5";

  try {
    let response;
    if (imageFile && imageFile.name) {
      const buffer = await imageFile.arrayBuffer();
      const blob = new Blob([buffer], { type: imageFile.type });
      const formData = new FormData();
      formData.append("file", blob, imageFile.name);
      formData.append("payload_json", JSON.stringify({
        username: "EternalSMP OC Register",
        embeds: [{
          title: "ğŸ—¡ï¸ Pendaftaran Karakter Baru",
          description: "Berikut detail karakter OC yang telah dikirim:",
          color: 0xFFA500,
          fields: fields,
          image: { url: "attachment://" + imageFile.name }
        }]
      }));
      response = await fetch(webhook, { method: "POST", body: formData });
    } else {
      response = await fetch(webhook, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          username: "EternalSMP OC Register",
          embeds: [{
            title: "ğŸ—¡ï¸ Pendaftaran Karakter Baru",
            description: "Berikut detail karakter OC yang telah dikirim:",
            color: 0xFFA500,
            fields: fields
          }]
        })
      });
    }

    if (!response.ok) {
      const errorText = await response.text();
      throw new Error("Discord Error: " + errorText);
    }

    alert("âœ… Pendaftaran berhasil dikirim!");
    form.reset();
    showPage("formPage");

  } catch (error) {
    alert("âŒ Gagal mengirim ke Discord. Cek konsol untuk detail.");
    console.error("Discord Webhook Error:", error.message);
  }
}
    </script>
    </body>
</html>
